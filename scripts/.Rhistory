library(data.table)
library(ggplot2)
library(igraph)
install.packages("igraph")
library(remotes)
remotes::install_github("igraph/rigraph@master")
clear()
clear
clc
library(BiocManager)
BiocManager::install("phyloseq")
pak::pak("igraph/rigraph")
BiocManager::install("pak")
library(pak)
pak::pak("igraph/rigraph")
.Last.error.trace
.Last.error
library(tidyverse)
BiocManager::install("tidyverse")
pak::install("ragg")
pak::pak("ragg")
BiocManager::install("tidyverse")
pak::pak("ggsci")
pak::pak("hdf5r")
.Last.error
library(pak)
pak::pak("rstan")
library(pak)
pak::pak_cleanup()
pak::pak("igraph")
.Last.error.trace
.Last.error
install.packages("igraph")
library("data.table")
library(abind)
library(igraph)
remove.packages("igraph")
remove.packages("igraph")
library(BiocManager)
install.packages("hdf5r", configure.args="--with-hdf5=/usr/local/hdf5/bin/h5cc")
Sys.getenv("LD_LIBRARY_PATH")
install.packages("hdf5r", configure.args="--with-hdf5=/usr/local/hdf5/bin/h5cc")
BiocManager::install("c(hdf5r)")
BiocManager::install(c("hdf5r"))
BiocManager::install("Seurat")
library(igraph)
library(Seurat)
library(oligoClasses)
BiocManager::install("phyloseq")
library(data.table)
library(ggplot2)
setwd(".")
stringdb_protein_info_df <- fread("../Data/StringDB_protein_info.csv")
setwd("/home/Raghvendra.Mall/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/")
stringdb_protein_info_df <- fread("../Data/StringDB_protein_info.csv")
stringdb_protein_info_df <- as.data.frame(stringdb_protein_info_df)
alphafold_df <- fread("../Data/Curated_AlphaFold_UniProtKB.csv")
alphafold_df <- as.data.frame(alphafold_df)
gene_names <- unlist(lapply(strsplit(alphafold_df$Gene_Name,split="_"),`[[`,1))
alphafold_df$hgnc_symbol <- gene_names
subset_alphafold_df <- alphafold_df[alphafold_df$hgnc_symbol %in% stringdb_protein_info_df$preferred_name,]
print(length(unique(gene_names)))
gene_names
View(subset_alphafold_df)
View(subset_alphafold_df)
View(stringdb_protein_info_df)
all_uniport_human_df <- fread("../../General_Data/uniprotkb_Human_2024_06_03.tsv")
gc()
gc()
source("~/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/subset_proteins_StringDB_AlphaFold.R")
colnames(all_uniprot_human_df)
all_uniprot_human_df$`Gene Names`
head(all_uniprot_human_df)
table(all_uniprot_human_df$Organism)
subset_uniprot_human_df <- all_uniprot_human_df[all_uniprot_human_df$Organism=="Human",]
subset_uniprot_human_df <- all_uniprot_human_df[all_uniprot_human_df$Organism=="Homo sapiens",]
grep("Homo",all_uniprot_human_df$Organism)
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo",all_uniprot_human_df$Organism),]
subset_uniprot_human_df$Organism
table(subset_uniprot_human_df$Organism)
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapeins (Human)",all_uniprot_human_df$Organism),]
table(subset_uniprot_human_df$Organism)
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapeins \(Human\)",all_uniprot_human_df$Organism),]
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapeins",all_uniprot_human_df$Organism),]
subset_uniprot_human_df$`Gene Names`
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapiens (Human)",all_uniprot_human_df$Organism),]
subset_uniprot_human_df$`Gene Names`
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapiens (Human)",all_uniprot_human_df$Organism),]
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapiens",all_uniprot_human_df$Organism),]
subset_uniprot_human_df$`Gene Names`
subset_uniprot_human_with_gene_names_df <- subset_uniprot_human_df[subset_uniprot_human_df$`Gene Names`!="",]
library(data.table)
library(ggplot2)
setwd("/home/Raghvendra.Mall/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/")
#Load the stringdb protein dataset
stringdb_protein_info_df <- fread("../Data/StringDB_protein_info.csv")
stringdb_protein_info_df <- as.data.frame(stringdb_protein_info_df)
#Load the proteins with structure in AlphaFold rep
alphafold_df <- fread("../Data/Curated_AlphaFold_UniProtKB.csv")
alphafold_df <- as.data.frame(alphafold_df)
#Get gene names and match with alphafold subset
gene_names_alphafold <- unlist(lapply(strsplit(alphafold_df$Gene_Name,split="_"),`[[`,1))
alphafold_df$hgnc_symbol <- gene_names_alphafold
intersect(gene_names_alphafold,stringdb_protein_info_df$preferred_name)
length(intersect(gene_names_alphafold,stringdb_protein_info_df$preferred_name))
intersect_gene_names <- intersect(alphafold_df$hgnc_symbol,stringdb_protein_info_df$preferred_name)
library(data.table)
library(ggplot2)
setwd("/home/Raghvendra.Mall/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/")
#Load the stringdb protein dataset
###############################################################################
stringdb_protein_info_df <- fread("../Data/StringDB_protein_info.csv")
stringdb_protein_info_df <- as.data.frame(stringdb_protein_info_df)
gene_names_stringdb <- stringdb_protein_info_df$preferred_name
#Load the proteins with structure in AlphaFold rep
###############################################################################
alphafold_df <- fread("../Data/Curated_AlphaFold_UniProtKB.csv")
alphafold_df <- as.data.frame(alphafold_df)
#Get gene names and match with alphafold subset
###############################################################################
gene_names_alphafold <- unlist(lapply(strsplit(alphafold_df$Gene_Name,split="_"),`[[`,1))
alphafold_df$hgnc_symbol <- gene_names_alphafold
intersect_gene_names <- intersect(gene_names_alphafold, gene_names_stringdb)
#Get all the human uniport ids
###############################################################################
all_uniprot_human_df <- fread("../../General_Data/uniprotkb_Human_2024_06_03.tsv")
all_uniprot_human_df <- as.data.frame(all_uniprot_human_df)
subset_uniprot_human_df <- all_uniprot_human_df[grep("Homo sapiens",all_uniprot_human_df$Organism),]
subset_uniprot_human_with_gene_names_df <- subset_uniprot_human_df[subset_uniprot_human_df$`Gene Names`!="",]
stringdb_gene_names
gene_names_stringdb[i]
gene_names_stringdb[1]
gene_name <- gene_names_stringdb[1]
grep("ARF5",subset_uniprot_human_with_gene_names_df$`Gene Names`)
subset_uniprot_human_with_gene_names_df[grep("ARF5",subset_uniprot_human_with_gene_names_df$`Gene Names`),]
grep("P84085",alphafold_df$UniProtId)
subset_uniprot_human_with_gene_names_df[grep("ARF5",subset_uniprot_human_with_gene_names_df$`Gene Names`),]$Entry
paste(subset_uniprot_human_with_gene_names_df[grep("ARF5",subset_uniprot_human_with_gene_names_df$`Gene Names`),]$Entry,collapse=";")
paste(subset_uniprot_human_with_gene_names_df[grep("ARF5",subset_uniprot_human_with_gene_names_df$`Gene Names`),]$Entry,collapse=" ; ")
source("~/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/subset_proteins_StringDB_AlphaFold.R")
mapping_df
mapping_df <- NULL
for (i in 1:length(gene_names_stringdb))
{
gene_name <- gene_names_stringdb[i]
uniprot_ids <- paste(subset_uniprot_human_with_gene_names_df[grep(gene_name,subset_uniprot_human_with_gene_names_df$`Gene Names`),]$Entry,collapse=" ; ")
temp <- cbind(gene_name, uniprot_ids)
mapping_df <- rbind(mapping_df, temp)
}
mapping_df <- as.data.frame(mapping_df)
colnames(mapping_df) <- c("gene_name_stringdb","uniprot_ids")
mapping_df
strsplit(mapping_df$uniprot_ids,split=" ; ")
apply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)
sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)
which(sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)>0)
sum(sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)>0)
subset_mapping_df <- mapping_df[length(mapping_df$uniprot_ids)>0,]
subset_mapping_df <- mapping_df[length(unlist(strsplit(mapping_df$uniprot_ids,split=" ; ")))>0,]
subset_mapping_df <- mapping_df[which(sapply(unlist(strsplit(mapping_df$uniprot_ids,split=" ; ")))>0),]
subset_mapping_df <- mapping_df[which(sapply(unlist(strsplit(mapping_df$uniprot_ids,split=" ; ")),length)>0),]
which(sapply(unlist(strsplit(mapping_df$uniprot_ids,split=" ; ")),length)>0)
sapply(unlist(strsplit(mapping_df$uniprot_ids,split=" ; ")),length)
strsplit(mapping_df$uniprot_ids,split=" ; "))
strsplit(mapping_df$uniprot_ids,split=" ; ")
sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)
which(sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)>0)
subset_mapping_df <- mapping_df[which(sapply(strsplit(mapping_df$uniprot_ids,split=" ; "),length)>0),]
subset_mapping_df
subset_stringdb_protein_info_df <- stringdb_protein_info_df[stringdb_protein_info_df$preferred_name %in% subset_mapping_df$gene_name_stringdb,]
write.table(subset_stringdb_protein_info_df,file = "../Data/StringDB_interactions.csv", row.names=F, col.names=T, quote=F, sep=" | ")
stringb_ppi_df <- fread("../Data/StringDB_interactions.csv")
stringdb_ppi_df <- fread("../Data/StringDB_interactions.csv")
stringdb_ppi_df <- as.data.frame(stringdb_ppi_df)
stringdb_ppi_df <- fread("../Data/StringDB_interactions.csv")
stringdb_ppi_df <- as.data.frame(stringdb_ppi_df)
stringb_ppi_df
library(data.table)
library(ggplot2)
setwd("/home/Raghvendra.Mall/TII/Projects/Raghav/CAR-T/Druggability_Score/scripts/")
ppi_df <- fread("../../General_Data/9606.protein.links.full.v12.0.txt.gz",header=T)
ppi_df <- as.data.frame(ppi_df)
#Subset protein protein interaction with confidence score > 400
subset_ppi_df <- ppi_df[ppi_df$combined_score>=400,]
#Load the protein information
protein_info_df <- fread("../../General_Data/9606.protein.info.v12.0.txt.gz",header=T)
protein_info_df <- as.data.frame(protein_info_df)
protein_ensmbl_names <- protein_info_df$`#string_protein_id`
rev_ppi_df <- subset_ppi_df[subset_ppi_df$protein1 %in% protein_ensmbl_names,]
final_ppi_df <- rev_ppi_df[rev_ppi_df$protein2 %in% protein_ensmbl_names,]
final_ppi_df$gene1 <- NA
final_ppi_df$gene2 <- NA
for (i in 1:nrow(final_ppi_df))
{
protein1 <- final_ppi_df$protein1[i]
protein2 <- final_ppi_df$protein2[i]
protein_name1 <- protein_info_df[protein_info_df$`#string_protein_id`==protein1,]$preferred_name
protein_name2 <- protein_info_df[protein_info_df$`#string_protein_id`==protein2,]$preferred_name
final_ppi_df$gene1[i] <- protein_name1
final_ppi_df$gene2[i] <- protein_name2
}
gc()
gc()
gc()
